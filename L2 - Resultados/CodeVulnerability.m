clear all;
close all;

clc

vul=newfis('Vulnerability');
%data = csvread('ESSALUD_fuzzy2.csv');
%Population Setup
vul=addvar(vul,'input','Population',[100 37000]);
vul=addmf(vul,'input',1,'Low','trapmf',  [-1.318e+04 -1376 7000 1.803e+04]);
vul=addmf(vul,'input',1,'Medium','trimf',  [9130 1.8e+04 2.97e+04]);
vul=addmf(vul,'input',1,'High','trapmf',  [1.8e+04 3.16e+04 51475 52000]);

%Congestion Setup
vul=addvar(vul,'input','Congestion',[0 0.33]); 

vul=addmf(vul,'input',2,'Low','trimf',   [-0.5 0 0.16]);
vul=addmf(vul,'input',2,'Medium','trimf',   [0 0.16 0.33  ]);
vul=addmf(vul,'input',2,'High','trimf',   [0.16 0.33 1 ]);

%Capacity setup
vul=addvar(vul,'input','Capacity',[0.02,0.92]);

vul=addmf(vul,'input',3,'Low','trimf',   [-0.2 0 0.46]);
vul=addmf(vul,'input',3,'Medium','trimf',   [0 0.46 0.92]);
vul=addmf(vul,'input',3,'High','trimf',   [0.46 0.92 1.5]);



%Vulnerability setup
vul=addvar(vul,'output','Vulnerability',[0 100]);             % Salida 

vul=addmf(vul,'output',1,'Low','trapmf',   [-36 -4 9.92 50]);
vul=addmf(vul,'output',1,'Medium','trimf',  [40 50 60]);
vul=addmf(vul,'output',1,'High','trapmf',   [50 99.3 104 136]);

%Rule Setup

ruleList=[ ...          %Las reglas las podemos sacar del toolbox con readfis
            1 1 1 1 1 1
            1 1 2 1 1 1
            1 1 3 1 1 1
            1 2 1 1 1 1
            1 2 2 1 1 1
            1 2 3 1 1 1
            1 3 1 1 1 1
            1 3 2 1 1 1
            1 3 3 1 1 1
            2 1 1 2 1 1
            2 1 2 2 1 1
            2 1 3 1 1 1
            2 2 1 2 1 1
            2 2 2 2 1 1
            2 2 3 2 1 1
            2 3 1 3 1 1
            2 3 2 3 1 1
            2 3 3 3 1 1
            3 1 1 2 1 1
            3 1 2 1 1 1
            3 1 3 1 1 1
            3 2 1 3 1 1
            3 2 2 3 1 1
            3 2 3 3 1 1
            3 3 1 3 1 1
            3 3 2 3 1 1
            3 3 3 3 1 1         
            ];

vul=addrule(vul,ruleList); % Adiciona las Reglas

figure(1)
plotfis(vul)
title('Block Diagram')

figure(2)
plotmf(vul,'input',1)
title('Population')

figure(3)
plotmf(vul,'input',2)
title('Congestion')

figure(4)
plotmf(vul,'output',1)
title('Output')

figure(5)
gensurf(vul)
title('FIS Behaivior')
grid on

figure(6)
gensurf(vul, [2,3]);
grid on

figure(7)
gensurf(vul, [1,3]);
grid on

